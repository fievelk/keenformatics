---
layout: post
title: How To create a global InitBinder in Spring with @ControllerAdvice
date: '2013-08-26T08:30:00.000+02:00'
author: fievelk
comments: true
tags:
- JEE
- date
- Spring 3
- How To
- Annotations
- InitBinder
- java
modified_time: '2013-08-26T08:55:49.855+02:00'
blogger_id: tag:blogger.com,1999:blog-8196940592943844696.post-2607709117369793907
blogger_orig_url: http://keenformatics.blogspot.com/2013/08/how-to-create-global-initbinder-in-spring.html

image:
  preview: initbinder.jpg

excerpt: "Date formatting could be an annoying problem when dealing with your views. I wrote an article about it when I was facing Json problems (see How To format dates in Json within Spring 3) but, as you may know, even if you don't need to use Json in your views, you'll probably have to face some troubles with date formats.
Sometimes you can avoid all your problems simply using the specific JSTL fmt in your jsp (see references). But what to do if you can't use JSTL in your jsp, or if a simple JSTL won't solve your problems?"
---

<section><a href="{{ site.url }}/img/posts/initbinder.jpg" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="235" src="{{ site.url }}/img/posts/initbinder.jpg" width="320" /></a><p>Date formatting could be an annoying problem when dealing with your views. I wrote an article about it when I was facing Json problems (see <a href="{{ site.baseurl }}{% post_url 2013-08-05-how-to-format-dates-in-json-within %}">How To format dates in Json within Spring 3</a>) but, as you may know, even if you don't need to use Json in your views, you'll probably have to face some troubles with date formats.</p>
<p>Sometimes you can avoid all your problems simply using the specific JSTL fmt in your jsp (see <a href="#references26082013">references</a>). But what to do if you can't use JSTL in your jsp, or if a simple JSTL won't solve your problems? Someone suggests to inject an InitBinder in your controller. What an InitBinder does is to grab your data from web request parameters and bind it to your JavaBean objects. So this could be a good solution if you have to deal with different kinds of data inputs in different controllers. But what if you have to always deal, for example, with dates? You could write a specific InitBinder for each of your controllers, but this is not a good procedure if you want to maximize your code efficiency by an accurate modularization (and this should be your aim, since you're using MVC paradigm). </p> <p>What I suggest you to do is to create something like a single global InitBinder, which will be activated everytime your application needs it, without any controller restriction. There's a really simple way to do so, using Spring <b>@ControllerAdvice</b> annotation. A class annotated with @ControllerAdvice is a class that assists every controller, and it's easily autodetected through Spring classpath scanning.</p> <p>If this is your case, and you want to create an InitBinder which manages your dates parsing them in (for example) dd/MM/yyyy format, here's what you can do.</p></section> <section><h2f>The steps!</h2f> <ol><li>Create a DateEditor class like this:  <pre class="prettyprint"><br />public class DateEditor extends PropertyEditorSupport {<br /> <br /> public void setAsText(String value) {<br />        try {<br />            setValue(new SimpleDateFormat("dd/MM/yyyy").parse(value));<br />        } catch(ParseException e) {<br />            setValue(null);<br />        }<br />    }<br /><br />    public String getAsText() {<br />     String s = "";<br />     if (getValue() != null) {<br />   s = new SimpleDateFormat("dd/MM/yyyy").format((Date) getValue());<br />  }<br />     return s;<br />    }<br /></pre></li> <li>Create a class annotated with @ControllerAdvice (I called it GlobalBindingInitializer):  <pre class="prettyprint"><br />@ControllerAdvice<br />public class GlobalBindingInitializer {<br /> <br /> /* Initialize a global InitBinder for dates instead of cloning its code in every Controller */<br /> <br /> @InitBinder<br /> public void binder(WebDataBinder binder) {<br />  binder.registerCustomEditor(Date.class, new DateEditor());<br /> }<br />}<br /></pre></li> <li>In your Spring MVC configuration file (for example webmvc-config.xml) add the lines that allow Spring to scan the package in which you created your GlobalBindingInitializer class. For example, if you created GlobalBindingInitializer in the org.example.common package:  <pre class="prettyprint"><br />&lt;context:component-scan base-package="org.example.common" /&gt;<br /></pre> </li></ol> <p>There's nothing else to do for your InitBinder date formatter to work. Remember that @ControllerAdvice is an extremely helpful annotation even when you have to handle exceptions, or if you want to create a global accessible @ModelAttribute for your application.</p> </section>  <section><h2f id="references26082013">References</h2f><ul><li><a href="http://static.springsource.org/spring/docs/2.5.x/api/org/springframework/web/bind/annotation/InitBinder.html">Spring Framework API 2.5 - Annotation Type InitBinder</a></li><li><a href="http://static.springsource.org/spring/docs/3.2.4.RELEASE/javadoc-api/org/springframework/web/bind/annotation/ControllerAdvice.html">Spring Framework 3.2.4 - Annotation Type ControllerAdvice</a></li><li><a href="http://docs.oracle.com/javaee/5/jstl/1.1/docs/tlddocs/fmt/tld-summary.html">Oracle Docs - JSTL fmt</a></li></ul></section>
